<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.4/dist/cdn.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
	<script type="text/javascript" src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
	<title>Document</title>
</head>

<body>
	<div x-data="{
		aoa: [[]],
		async upload (e) {
			const file = e.currentTarget.files[0]
			await file.arrayBuffer().then( function (raw) {
				const spreadsheet = XLSX.read(raw, { cellDates: true })
				const sheetName = spreadsheet.SheetNames[0]
				const worksheet = spreadsheet.Sheets[sheetName]
				const rest = XLSX.utils.sheet_to_json(worksheet, { header: 1 })
				let result = []
				rest.forEach( function (cols) {
					if (cols[3]) {
						result.push([
							cols[1], 
							cols[3], 
							cols[4], 
							cols[6], 
							cols[12], 
							cols[16], 
							cols[19], 
							cols[24], 
							cols[26], 
							cols[29], 
						])
					}
				})
				this.aoa = result
			}.bind(this))
		},

	}">

		<div class="p-4 flex flex-wrap gap-4 print:hidden select-none">
			<div class="">
				<label class="cursor-pointer">
					Upload file.xlsx
					<input type="file" class="cursor-pointer text-cyan-500" accept=".xlsx" @change="upload($event)" />
				</label>
			</div>
		</div>

		<div class="">
			<table>
				<tbody>
					<template x-for="cols in aoa">
						<tr>
							<template x-for="value in cols">
								<td class="border px-1" x-text="value"></td>
							</template>
						</tr>
					</template>
				</tbody>
			</table>
		</div>

	</div>
</body>

</html>